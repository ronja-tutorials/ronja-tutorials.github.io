<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Texture Dissolve | Ronja&#39;s tutorials</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="This tutorial is about how to make Meshes dissolve in the pattern of a texture. We will use a surface shader for this tutorial, so if you don&rsquo;t understand how they work yet, I can refer you to my tutorial about them here. This tutorial will also just work with opaque shaders, but you can also use the same principles on transparent or unlit shaders.
Simple Dissolve We start by adding a new texture to our shader to drive the dissolve.">
    <meta name="generator" content="Hugo 0.76.5" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.d876a0cc99d23e9edadbac7fc6abde13.css" rel="stylesheet">
    

    

    
      

    

    
    
    <meta property="og:title" content="Texture Dissolve" />
<meta property="og:description" content="This tutorial is about how to make Meshes dissolve in the pattern of a texture. We will use a surface shader for this tutorial, so if you don&rsquo;t understand how they work yet, I can refer you to my tutorial about them here. This tutorial will also just work with opaque shaders, but you can also use the same principles on transparent or unlit shaders.
Simple Dissolve We start by adding a new texture to our shader to drive the dissolve." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ronja-tutorials.com/post/038-dissolve/" />
<meta property="article:published_time" content="2018-12-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-12-15T00:00:00+00:00" />
<meta itemprop="name" content="Texture Dissolve">
<meta itemprop="description" content="This tutorial is about how to make Meshes dissolve in the pattern of a texture. We will use a surface shader for this tutorial, so if you don&rsquo;t understand how they work yet, I can refer you to my tutorial about them here. This tutorial will also just work with opaque shaders, but you can also use the same principles on transparent or unlit shaders.
Simple Dissolve We start by adding a new texture to our shader to drive the dissolve.">
<meta itemprop="datePublished" content="2018-12-15T00:00:00+00:00" />
<meta itemprop="dateModified" content="2018-12-15T00:00:00+00:00" />
<meta itemprop="wordCount" content="1008">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Texture Dissolve"/>
<meta name="twitter:description" content="This tutorial is about how to make Meshes dissolve in the pattern of a texture. We will use a surface shader for this tutorial, so if you don&rsquo;t understand how they work yet, I can refer you to my tutorial about them here. This tutorial will also just work with opaque shaders, but you can also use the same principles on transparent or unlit shaders.
Simple Dissolve We start by adding a new texture to our shader to drive the dissolve."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Ronja&#39;s tutorials
      
    </a>
    <div class="flex-l items-center">
      

      
      















    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw7 center ph3">
    <header class="mt5 w-100">
      
      
      <h1 class="f1 athelas mt3 mb1">Texture Dissolve</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2018-12-15T00:00:00Z">December 15, 2018</time>

      
      
    </header>
    <div class="w-100 nested-copy-line-height lh-copy sans-serif f4 nested-links nested-img mid-gray pr4-l"><p>This tutorial is about how to make Meshes dissolve in the pattern of a texture. We will use a surface shader for this tutorial, so if you don&rsquo;t understand how they work yet, I can refer you to <a href="https://ronja-tutorials.com/post/005-simple-surface/">my tutorial about them here</a>. This tutorial will also just work with opaque shaders, but you can also use the same principles on transparent or unlit shaders.</p>
<h2 id="simple-dissolve">Simple Dissolve</h2>
<p>We start by adding a new texture to our shader to drive the dissolve. We&rsquo;ll simply use the uv coordinates and then write the result to the albedo channel. If our model doesn&rsquo;t let us do that we can also use different UV coordinates, for example screenspace or <a href="https://ronja-tutorials.com/post/010-triplanar-mapping/">triplanar</a> ones or even <a href="/noise.html">generate the data procedurally</a>.</p>
<p>From the read value we&rsquo;ll only use the red channel. Any single channel is fine, the red one just happens to be the first. If you use several things that use a single texture channel you can also use different channels of a single texture.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">//in properties</span>

_DissolveTex (<span style="color:#f00;background-color:#faa">&#34;</span>Dissolve Texture<span style="color:#f00;background-color:#faa">&#34;</span>, <span style="color:#00d;font-weight:bold">2</span>D) <span style="color:#333">=</span> <span style="color:#f00;background-color:#faa">&#34;</span>black<span style="color:#f00;background-color:#faa">&#34;</span> {}
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in CGPROGRAM with other shader variables</span>

<span style="color:#080;font-weight:bold">sampler2D</span> _DissolveTex;
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in input struct</span>
float2 uv_DissolveTex;
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in surface function</span>

<span style="color:#080;font-weight:bold">float</span> dissolve <span style="color:#333">=</span> tex2D(_DissolveTex, i.uv_DissolveTex).r;

o.Albedo <span style="color:#333">=</span> dissolve;
</code></pre></div><p>The dissolve texture I&rsquo;m using is a perlin texture I baked via the <a href="https://ronja-tutorials.com/post/030-baking_shaders/">material baking tool</a> I explained in a previous tutorial.</p>
<p><img src="/assets/images/posts/038/DissolvePattern.png" alt=""></p>
<p>When outputting the texture as the albedo channel, the model should look approximately like this:</p>
<p><img src="/assets/images/posts/038/DissolveTex.png" alt=""></p>
<p>The next step is to make the model disappear depending on a dissolve value. For this we use the clip function. When we pass a negative value to it the shader stops calculations and doesn&rsquo;t render the pixel. If we pass it a positive value or zero the function does nothing. So to make the black areas of out dissolve texture to disappear first, we subtract the dissolve value from the dissolve pattern. With a dissolve value of zero there won&rsquo;t be any negative values, so the model will render as usual. When we increase the dissolve value, all the pixels where the texture value is less than the dissove variable the result of the subtraction will be negative and the model won&rsquo;t render until the dissolve value is at 1 where only pixels will be shown where the texture is white. To stop white pixels from always showing we can multiply the texture value by a number close to 1, but a bit less, so it never reaches 1.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in properties</span>

_DissolveAmount (<span style="color:#f00;background-color:#faa">&#34;</span>Dissolve Amount<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)) <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">0.5</span>
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in CGPROGRAM with other shader variables</span>

<span style="color:#080;font-weight:bold">float</span> _DissolveAmount;
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in surface method</span>

<span style="color:#080;font-weight:bold">float</span> dissolve <span style="color:#333">=</span> tex2D(_DissolveTex, i.uv_DissolveTex).r;
dissolve <span style="color:#333">=</span> dissolve <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">0.999</span>;
<span style="color:#080;font-weight:bold">float</span> isVisible <span style="color:#333">=</span> dissolve <span style="color:#333">-</span> _DissolveAmount;
clip(isVisible);
</code></pre></div><p><img src="/assets/images/posts/038/DissolveTexDissolve.png" alt=""></p>
<p>Now the last fix is to stop outputting the dissolve texture to the albedo channel and instead use the color texture we used previously. Depending on your shader, the whole surface function could look something like this.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#080;font-weight:bold">void</span> surf (Input i, <span style="color:#080;font-weight:bold">inout</span> SurfaceOutputStandard o) {
    <span style="color:#080;font-weight:bold">float</span> dissolve <span style="color:#333">=</span> tex2D(_DissolveTex, i.uv_DissolveTex).r;
    dissolve <span style="color:#333">=</span> dissolve <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">0.999</span>;
    <span style="color:#080;font-weight:bold">float</span> isVisible <span style="color:#333">=</span> dissolve <span style="color:#333">-</span> _DissolveAmount;
    clip(isVisible);

    fixed4 col <span style="color:#333">=</span> tex2D(_MainTex, i.uv_MainTex);
    col <span style="color:#333">*=</span> _Color;

    o.Albedo <span style="color:#333">=</span> dissolve;
    o.Metallic <span style="color:#333">=</span> _Metallic;
    o.Smoothness <span style="color:#333">=</span> _Smoothness;
    o.Emission <span style="color:#333">=</span> _Emission;
}
</code></pre></div><p><img src="/assets/images/posts/038/SimpleDissolve.gif" alt=""></p>
<h2 id="dissolve-highlight">Dissolve Highlight</h2>
<p>Because the <code>isVisible</code> variable slowly approaches zero, we can predict when we&rsquo;re about to discard a pixel. A common effect is to make that border, just before we discard the pixel, glow. For that we&rsquo;ll define a glow color, glow range and glow falloff. If you want to you can also use different metrics to decorate the border, including using a completely customisable texture like we did in the <a href="https://ronja-tutorials.com/post/013-custom-lighting/">custom lighting tutorial</a>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">//in properties</span>

[Header(Glow)]
[HDR]_GlowColor(<span style="color:#f00;background-color:#faa">&#34;</span>Color<span style="color:#f00;background-color:#faa">&#34;</span>, Color) <span style="color:#333">=</span> (<span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">1</span>)
_GlowRange(<span style="color:#f00;background-color:#faa">&#34;</span>Range<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">.5</span>)) <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">0.1</span>
_GlowFalloff(<span style="color:#f00;background-color:#faa">&#34;</span>Falloff<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)) <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">0.1</span>
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in CGPROGRAM with other shader variables</span>

float3 _GlowColor;
<span style="color:#080;font-weight:bold">float</span> _GlowRange;
<span style="color:#080;font-weight:bold">float</span> _GlowFalloff;
</code></pre></div><p>When we have those variables we can define where the glow should appear by doing a smoothstep. Because we want the lower values of the <code>isVisible</code> variable to map to higher visibility of the glow (0 is always 100% glowing and higher numbers mean further away from the cutoff) we first pass the glowrange plus the falloff, as a second parameter we pass just the glow range andthe third parameter is the one we evaluate, the <code>isVisible</code> variable itself. By doing this everything that&rsquo;s closer to the cutoff than <code>_GlowRange</code> is completely glowing and everything that&rsquo;s between <code>_GlowRange</code> and <code>_GlowRange</code> + <code>_GlowFalloff</code> has a gradient. We then multiply the variable that defines wether the pixel is glowing or not by the glow color and add it to the base emissive value of the shader.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#888">// in surface method</span>

<span style="color:#080;font-weight:bold">float</span> isGlowing <span style="color:#333">=</span> smoothstep(_GlowRange <span style="color:#333">+</span> _GlowFalloff, _GlowRange, isVisible);
float3 glow <span style="color:#333">=</span> isGlowing <span style="color:#333">*</span> _GlowColor;

o.Emission <span style="color:#333">=</span> _Emission <span style="color:#333">+</span> glow;
</code></pre></div><p><img src="/assets/images/posts/038/Result.gif" alt=""></p>
<h2 id="source">Source</h2>
<ul>
<li><a href="https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/038_Dissolve/Dissolve.shader">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/038_Dissolve/Dissolve.shader</a></li>
</ul>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl">Shader <span style="color:#f00;background-color:#faa">&#34;</span>Tutorial<span style="color:#333">/</span><span style="color:#40e;font-weight:bold">03</span><span style="color:#00d;font-weight:bold">8</span>_dissolve<span style="color:#f00;background-color:#faa">&#34;</span> {
    Properties {
        _Color (<span style="color:#f00;background-color:#faa">&#34;</span>Tint<span style="color:#f00;background-color:#faa">&#34;</span>, Color) <span style="color:#333">=</span> (<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#40e;font-weight:bold">0</span>, <span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)
        _MainTex (<span style="color:#f00;background-color:#faa">&#34;</span>Texture<span style="color:#f00;background-color:#faa">&#34;</span>, <span style="color:#00d;font-weight:bold">2</span>D) <span style="color:#333">=</span> <span style="color:#f00;background-color:#faa">&#34;</span>white<span style="color:#f00;background-color:#faa">&#34;</span> {}
        _Smoothness (<span style="color:#f00;background-color:#faa">&#34;</span>Smoothness<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)) <span style="color:#333">=</span> <span style="color:#40e;font-weight:bold">0</span>
        _Metallic (<span style="color:#f00;background-color:#faa">&#34;</span>Metalness<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)) <span style="color:#333">=</span> <span style="color:#40e;font-weight:bold">0</span>
        [HDR] _Emission (<span style="color:#f00;background-color:#faa">&#34;</span>Emission<span style="color:#f00;background-color:#faa">&#34;</span>, color) <span style="color:#333">=</span> (<span style="color:#40e;font-weight:bold">0</span>,<span style="color:#40e;font-weight:bold">0</span>,<span style="color:#40e;font-weight:bold">0</span>)

        [Header(Dissolve)]
        _DissolveTex (<span style="color:#f00;background-color:#faa">&#34;</span>Dissolve Texture<span style="color:#f00;background-color:#faa">&#34;</span>, <span style="color:#00d;font-weight:bold">2</span>D) <span style="color:#333">=</span> <span style="color:#f00;background-color:#faa">&#34;</span>black<span style="color:#f00;background-color:#faa">&#34;</span> {}
        _DissolveAmount (<span style="color:#f00;background-color:#faa">&#34;</span>Dissolve Amount<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)) <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">0.5</span>

        [Header(Glow)]
        [HDR]_GlowColor(<span style="color:#f00;background-color:#faa">&#34;</span>Color<span style="color:#f00;background-color:#faa">&#34;</span>, Color) <span style="color:#333">=</span> (<span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">1</span>)
        _GlowRange(<span style="color:#f00;background-color:#faa">&#34;</span>Range<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">.3</span>)) <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">0.1</span>
        _GlowFalloff(<span style="color:#f00;background-color:#faa">&#34;</span>Falloff<span style="color:#f00;background-color:#faa">&#34;</span>, Range(<span style="color:#60e;font-weight:bold">0.001</span>, <span style="color:#60e;font-weight:bold">.3</span>)) <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">0.1</span>
    }
    SubShader {
        Tags{ <span style="color:#f00;background-color:#faa">&#34;</span>RenderType<span style="color:#f00;background-color:#faa">&#34;</span><span style="color:#333">=</span><span style="color:#f00;background-color:#faa">&#34;</span>Opaque<span style="color:#f00;background-color:#faa">&#34;</span> <span style="color:#f00;background-color:#faa">&#34;</span>Queue<span style="color:#f00;background-color:#faa">&#34;</span><span style="color:#333">=</span><span style="color:#f00;background-color:#faa">&#34;</span>Geometry<span style="color:#f00;background-color:#faa">&#34;</span>}

        CGPROGRAM

        <span style="color:#f00;background-color:#faa">#</span>pragma surface surf Standard fullforwardshadows
        <span style="color:#f00;background-color:#faa">#</span>pragma target <span style="color:#60e;font-weight:bold">3.0</span>

        <span style="color:#080;font-weight:bold">sampler2D</span> _MainTex;
        fixed4 _Color;

        <span style="color:#080;font-weight:bold">half</span> _Smoothness;
        <span style="color:#080;font-weight:bold">half</span> _Metallic;
        half3 _Emission;

        <span style="color:#080;font-weight:bold">sampler2D</span> _DissolveTex;
        <span style="color:#080;font-weight:bold">float</span> _DissolveAmount;

        float3 _GlowColor;
        <span style="color:#080;font-weight:bold">float</span> _GlowRange;
        <span style="color:#080;font-weight:bold">float</span> _GlowFalloff;

        <span style="color:#080;font-weight:bold">struct</span> Input {
            float2 uv_MainTex;
            float2 uv_DissolveTex;
        };

        <span style="color:#080;font-weight:bold">void</span> surf (Input i, <span style="color:#080;font-weight:bold">inout</span> SurfaceOutputStandard o) {
            <span style="color:#080;font-weight:bold">float</span> dissolve <span style="color:#333">=</span> tex2D(_DissolveTex, i.uv_DissolveTex).r;
            dissolve <span style="color:#333">=</span> dissolve <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">0.999</span>;
            <span style="color:#080;font-weight:bold">float</span> isVisible <span style="color:#333">=</span> dissolve <span style="color:#333">-</span> _DissolveAmount;
            clip(isVisible);

            <span style="color:#080;font-weight:bold">float</span> isGlowing <span style="color:#333">=</span> smoothstep(_GlowRange <span style="color:#333">+</span> _GlowFalloff, _GlowRange, isVisible);
            float3 glow <span style="color:#333">=</span> isGlowing <span style="color:#333">*</span> _GlowColor;

            fixed4 col <span style="color:#333">=</span> tex2D(_MainTex, i.uv_MainTex);
            col <span style="color:#333">*=</span> _Color;

            o.Albedo <span style="color:#333">=</span> col;
            o.Metallic <span style="color:#333">=</span> _Metallic;
            o.Smoothness <span style="color:#333">=</span> _Smoothness;
            o.Emission <span style="color:#333">=</span> _Emission <span style="color:#333">+</span> glow;
        }
        ENDCG
    }
    FallBack <span style="color:#f00;background-color:#faa">&#34;</span>Standard<span style="color:#f00;background-color:#faa">&#34;</span>
}
</code></pre></div><p>Now you know how to make meshes dissolve into nothing with shaders! The next tutorial will probably be about signed distance fields again so stay tuned for that.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "disqus_vlgXjcPhg1" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
      
      </div>
    </div>


  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://ronja-tutorials.com" >
    &copy;  Ronja's tutorials 2020 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
