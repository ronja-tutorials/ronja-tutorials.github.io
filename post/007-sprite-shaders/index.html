<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Sprite Shaders | Ronja&#39;s tutorials</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Summary In unity the way sprites are rendered is very similar to the way 3d objects are rendered. Most of the work is done by the sprite renderer component. I’ll go a bit over what the component is doing and how we can change our shader to do some of the stuff the default sprite renderer is doing.
This tutorial will build on the transparent shader we made previously so it’s best that you understand that one first.">
    <meta name="generator" content="Hugo 0.76.5" />
    
    
		<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
		<link rel="canonical" href="https://www.ronja-tutorials.com/post/007-sprite-shaders/">

    
    
      <link href="/dist/css/app.d876a0cc99d23e9edadbac7fc6abde13.css" rel="stylesheet">
    

    
      <link rel="stylesheet" href="/css/main.css">
    

    
      

    

    
    
    <meta property="og:title" content="Sprite Shaders" />
<meta property="og:description" content="Summary In unity the way sprites are rendered is very similar to the way 3d objects are rendered. Most of the work is done by the sprite renderer component. I’ll go a bit over what the component is doing and how we can change our shader to do some of the stuff the default sprite renderer is doing.
This tutorial will build on the transparent shader we made previously so it’s best that you understand that one first." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ronja-tutorials.com/post/007-sprite-shaders/" />
<meta property="article:published_time" content="2018-04-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-04-13T00:00:00+00:00" />
<meta itemprop="name" content="Sprite Shaders">
<meta itemprop="description" content="Summary In unity the way sprites are rendered is very similar to the way 3d objects are rendered. Most of the work is done by the sprite renderer component. I’ll go a bit over what the component is doing and how we can change our shader to do some of the stuff the default sprite renderer is doing.
This tutorial will build on the transparent shader we made previously so it’s best that you understand that one first.">
<meta itemprop="datePublished" content="2018-04-13T00:00:00+00:00" />
<meta itemprop="dateModified" content="2018-04-13T00:00:00+00:00" />
<meta itemprop="wordCount" content="723">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Sprite Shaders"/>
<meta name="twitter:description" content="Summary In unity the way sprites are rendered is very similar to the way 3d objects are rendered. Most of the work is done by the sprite renderer component. I’ll go a bit over what the component is doing and how we can change our shader to do some of the stuff the default sprite renderer is doing.
This tutorial will build on the transparent shader we made previously so it’s best that you understand that one first."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Ronja&#39;s tutorials
      
    </a>
    <div class="flex-l items-center">
      

      
      















    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw7 center ph3">
    <header class="mt5 w-100">
      <h1 class="f1 athelas mt3 mb1">Sprite Shaders</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2018-04-13T00:00:00Z">April 13, 2018</time>

      
      
		</header>
		
		<div style="margin-bottom: 70px;">
			<h3>Table Of Contents</h3>
			<nav id="TableOfContents">
  <ul>
    <li><a href="#summary">Summary</a></li>
    <li><a href="#scene-setup">Scene Setup</a></li>
    <li><a href="#changing-the-shader">Changing the Shader</a></li>
  </ul>
</nav>
		</div>

    <div class="w-100 nested-copy-line-height lh-copy sans-serif f4 nested-links nested-img mid-gray pr4-l"><div>
				
				<h2 id="summary">Summary <a href="#summary" class="hanchor" ariaLabel="Anchor">🔗&#xFE0E;</a> </h2>
<p>In unity the way sprites are rendered is very similar to the way 3d objects are rendered. Most of the work is done by the sprite renderer component. I’ll go a bit over what the component is doing and how we can change our shader to do some of the stuff the default sprite renderer is doing.</p>
<p>This tutorial will build on <a href="https://www.ronja-tutorials.com/post/006-simple-transparency/">the transparent shader</a> we made previously so it’s best that you understand <a href="https://www.ronja-tutorials.com/post/006-simple-transparency/">that one</a> first.</p>
<p><img src="/assets/images/posts/007/Result.png" alt="Result"></p>
<h2 id="scene-setup">Scene Setup <a href="#scene-setup" class="hanchor" ariaLabel="Anchor">🔗&#xFE0E;</a> </h2>
<p>To work on sprite shaders I’ll change the scene to be simpler. I made the camera orthographic, replaced the cube I used in previous examples with a sprite renderer and converted the images I use to sprites.</p>
<p><img src="/assets/images/posts/007/Hierarchy.png" alt="hierarchy with camera and sprite"><!-- raw HTML omitted -->
<img src="/assets/images/posts/007/CameraInspector.png" alt="Inspector window of orthographic camera"><!-- raw HTML omitted -->
<img src="/assets/images/posts/007/SpriteInspector.png" alt="Inspector window of configured sprite renderer"><!-- raw HTML omitted -->
<img src="/assets/images/posts/007/SpriteImporter.png" alt="Inspector window of the sprite importer"></p>
<h2 id="changing-the-shader">Changing the Shader <a href="#changing-the-shader" class="hanchor" ariaLabel="Anchor">🔗&#xFE0E;</a> </h2>
<p>With all of those changes and the transparent material put into the material slot of the sprite renderer, everything already seems to work.</p>
<p>The sprite renderer component automatically generates a mesh based on our image and sets the UV coordinates of it so it works just like the 3d models we’re used to. It puts the color of the sprite renderer into the vertex colors of the generated mesh and it assorts the vertices in a flipped shape when we activate flip X or Y. It also communicates with the unity render pipeline so sprites that have a higher sorting layer get rendered later and are drawn on top.</p>
<p>Our shader currently doesn’t support mirroring and vertex colors, so let’s fix that.</p>
<p>The reason our sprite disappears when we flip it (and reappears when we flip it in x and y) is that to flip the sprite around the x axis, the renderer basically rotates it 180° around the y axis and then we see the back of it and because of a optimisation called “backface culling” the backsides of faces aren’t rendered. Usually backface culling is good, because when we don’t see the inside of a object, why render it. And backfaces usually have wrong lighting anyways, because their normals face away from the camera.</p>
<p>In this case we don’t have to worry about either of those things though, sprites don’t have a “inside” that could be optimised and we also don’t do lighting, so we can just disable backface culling. we can do that in the subshader or the shader pass.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl">Cull Off
</code></pre></div><p>To get the vertex colors we add a new 4d(red, green, blue, alpha) variable to our input stuct and vertex to fragment struct and mark it as color. Then we transfer the color  from the input to the v2f struct in the vertex shader and in the fragment shader multiply our return color with it;</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl"><span style="color:#080;font-weight:bold">struct</span> appdata{
    float4 vertex <span style="color:#333">:</span> POSITION;
    float2 uv <span style="color:#333">:</span> TEXCOORD0;
    fixed4 color <span style="color:#333">:</span> COLOR;
};

<span style="color:#080;font-weight:bold">struct</span> v2f{
    float4 position <span style="color:#333">:</span> SV_POSITION;
    float2 uv <span style="color:#333">:</span> TEXCOORD0;
    fixed4 color <span style="color:#333">:</span> COLOR;
};

v2f vert(appdata v){
    v2f o;
    o.position <span style="color:#333">=</span> UnityObjectToClipPos(v.vertex);
    o.uv <span style="color:#333">=</span> TRANSFORM_TEX(v.uv, _MainTex);
    o.color <span style="color:#333">=</span> v.color;
    <span style="color:#080;font-weight:bold">return</span> o;
}

fixed4 frag(v2f i) <span style="color:#333">:</span> SV_TARGET{
    fixed4 col <span style="color:#333">=</span> tex2D(_MainTex, i.uv);
    col <span style="color:#333">*=</span> _Color;
    col <span style="color:#333">*=</span> i.color;
    <span style="color:#080;font-weight:bold">return</span> col;
}
</code></pre></div><p>With those changes the shader will now act as we expect it to and we can expand it to do other stuff we’re interrested in in the future.</p>
<p><img src="/assets/images/posts/007/AdjustVariables.gif" alt="Playing around with the variables"></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-glsl" data-lang="glsl">Shader <span style="color:#f00;background-color:#faa">&#34;</span>Tutorial<span style="color:#333">/</span><span style="color:#40e;font-weight:bold">007</span>_Sprite<span style="color:#f00;background-color:#faa">&#34;</span>{
	Properties{
		_Color (<span style="color:#f00;background-color:#faa">&#34;</span>Tint<span style="color:#f00;background-color:#faa">&#34;</span>, Color) <span style="color:#333">=</span> (<span style="color:#40e;font-weight:bold">0</span>, <span style="color:#40e;font-weight:bold">0</span>, <span style="color:#40e;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)
		_MainTex (<span style="color:#f00;background-color:#faa">&#34;</span>Texture<span style="color:#f00;background-color:#faa">&#34;</span>, <span style="color:#00d;font-weight:bold">2</span>D) <span style="color:#333">=</span> <span style="color:#f00;background-color:#faa">&#34;</span>white<span style="color:#f00;background-color:#faa">&#34;</span> {}
	}

	SubShader{
		Tags{ 
			<span style="color:#f00;background-color:#faa">&#34;</span>RenderType<span style="color:#f00;background-color:#faa">&#34;</span><span style="color:#333">=</span><span style="color:#f00;background-color:#faa">&#34;</span>Transparent<span style="color:#f00;background-color:#faa">&#34;</span> 
			<span style="color:#f00;background-color:#faa">&#34;</span>Queue<span style="color:#f00;background-color:#faa">&#34;</span><span style="color:#333">=</span><span style="color:#f00;background-color:#faa">&#34;</span>Transparent<span style="color:#f00;background-color:#faa">&#34;</span>
		}

		Blend SrcAlpha OneMinusSrcAlpha

		ZWrite off
		Cull off

		Pass{

			CGPROGRAM

			<span style="color:#f00;background-color:#faa">#</span>include <span style="color:#f00;background-color:#faa">&#34;</span>UnityCG.cginc<span style="color:#f00;background-color:#faa">&#34;</span>

			<span style="color:#f00;background-color:#faa">#</span>pragma vertex vert
			<span style="color:#f00;background-color:#faa">#</span>pragma fragment frag

			<span style="color:#080;font-weight:bold">sampler2D</span> _MainTex;
			float4 _MainTex_ST;

			fixed4 _Color;

			<span style="color:#080;font-weight:bold">struct</span> appdata{
				float4 vertex <span style="color:#333">:</span> POSITION;
				float2 uv <span style="color:#333">:</span> TEXCOORD0;
				fixed4 color <span style="color:#333">:</span> COLOR;
			};

			<span style="color:#080;font-weight:bold">struct</span> v2f{
				float4 position <span style="color:#333">:</span> SV_POSITION;
				float2 uv <span style="color:#333">:</span> TEXCOORD0;
				fixed4 color <span style="color:#333">:</span> COLOR;
			};

			v2f vert(appdata v){
				v2f o;
				o.position <span style="color:#333">=</span> UnityObjectToClipPos(v.vertex);
				o.uv <span style="color:#333">=</span> TRANSFORM_TEX(v.uv, _MainTex);
				o.color <span style="color:#333">=</span> v.color;
				<span style="color:#080;font-weight:bold">return</span> o;
			}

			fixed4 frag(v2f i) <span style="color:#333">:</span> SV_TARGET{
				fixed4 col <span style="color:#333">=</span> tex2D(_MainTex, i.uv);
				col <span style="color:#333">*=</span> _Color;
				col <span style="color:#333">*=</span> i.color;
				<span style="color:#080;font-weight:bold">return</span> col;
			}

			ENDCG
		}
	}
}
</code></pre></div><p>The sprite renderer component also prepares the mesh so spritesheets, polygon sprites and animations work with our shader.</p>
<p>What the sprite shader from unity does support, but ours doesn’t so far is instancing, pixel snapping and a external alpha channel, but that’s either too complex for now or edge cases most people don’t use so I decided to not implement them here.</p>
<p>You can also find the source code here <a href="https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/007_Sprites/sprite.shader">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/007_Sprites/sprite.shader</a>.</p>

			</div>I hope you enjoyed my tutorial ✨. If you want to support me further feel free to follow me on <a href="https://twitter.com/totallyRonja">twitter</a>, 
			throw me a one-time donation via <a href="https://ko-fi.com/ronjatutorials">ko-fi</a> 
			or support me on <a href="https://www.patreon.com/RonjaTutorials">patreon</a> 
			(I try to put updates also there, but I fail most of the time, bear with me 💖).<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>


  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://www.ronja-tutorials.com" >
    &copy;  Ronja's tutorials 2021 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
