<!DOCTYPE html>
<html lang="en">

  <head>

    <!-- Non social metatags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="theme-color" content="#157878">

    

    <title>Layered Noise</title>

    
      <!-- Update your html tag to include the itemscope and itemtype attributes. -->
<html itemscope itemtype="http://schema.org/Article">












<!-- Place this data between the <head> tags of your website -->

  <meta name="author" content="Ronja Böhringer">

<meta name="description" content="Layered Noise So far the noise we generated always looked either very soft, or very noisy. We can improve that by layering multiple layers of noise o..." />





<!-- Schema.org markup for Google+ -->
<meta itemprop="name" content="Layered Noise">
<meta itemprop="description" content="Layered Noise So far the noise we generated always looked either very soft, or very noisy. We can improve that by layering multiple layers of noise o...">

  <meta itemprop="image" content="https://www.ronja-tutorials.com/assets/images/posts/027/Result.gif">


<!-- Twitter Card data -->
<meta name="twitter:card" content="summary_large_image">



<meta name="twitter:title" content="Layered Noise">
<meta name="twitter:description" content="Layered Noise So far the noise we generated always looked either very soft, or very noisy. We can improve that by layering multiple layers of noise o...">


  <meta name="twitter:creator" content="@TotallyRonja">


<!-- Twitter summary card with large image must be at least 280x150px -->

  <meta name="twitter:image:src" content="https://www.ronja-tutorials.com/assets/images/posts/027/Result.gif">
  <meta property="twitter:image" content="https://www.ronja-tutorials.com/assets/images/posts/027/Result.gif">

<meta property="twitter:url" content="https://www.ronja-tutorials.com/2018/09/22/layered-noise.html">

<!-- Open Graph data -->
<meta property="og:title" content="Layered Noise" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ronja-tutorials.com/2018/09/22/layered-noise.html" />

  <meta property="og:image" content="https://www.ronja-tutorials.com/assets/images/posts/027/Result.gif" />

<meta property="og:description" content="Layered Noise So far the noise we generated always looked either very soft, or very noisy. We can improve that by layering multiple layers of noise o..." />
<meta property="og:site_name" content="Ronja's Shader Tutorials" />

  <meta property="article:published_time" content="2018-09-22T00:00:00+02:00" />














  





  




    

    <link rel="canonical" href="https://www.ronja-tutorials.com/2018/09/22/layered-noise.html">

    

    <!-- <link rel="shortcut icon" href="https://www.ronja-tutorials.com/favicon.ico"> -->
    <meta name="robots" content="noarchive">

    <!-- <link rel="alternate" media="only screen and (max-width: 640px)" href="">
    <link rel="alternate" media="handheld" href=""> -->


    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <script async defer data-website-id="fb34d410-ef67-4a3a-8fdc-01a05f5e22b2" src="https://stats.ruby0x1.ca/umami.js" ></script>
    <link rel="stylesheet" href="/assets/css/style.css?v=">
  </head>
  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    

    
      <a class="site-title" href="/">Ronja&#39;s Shader Tutorials</a>
    
    <!-- SVG icons from https://iconmonstr.com -->

    <!-- Twitter icon -->
    <span class="my-span-icon">
        <a href="https://twitter.com/TotallyRonja" aria-label="'s Twitter" title="'s Twitter">
          <svg class="my-svg-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" style="margin-top: 12px;margin-left: 13px;"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"/></svg>
        </a>
      </span>

      <!-- RSS icon -->
      
        <span class="my-span-icon">
          <a href="/feed.xml" aria-label="RSS feed" title="'s RSS feed">
            <svg class="my-svg-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-3.374 17c-.897 0-1.626-.727-1.626-1.624s.729-1.624 1.626-1.624 1.626.727 1.626 1.624-.729 1.624-1.626 1.624zm3.885 0c-.03-3.022-2.485-5.474-5.511-5.504v-2.406c4.361.03 7.889 3.555 7.92 7.91h-2.409zm4.081 0c-.016-5.297-4.303-9.571-9.592-9.594v-2.406c6.623.023 11.985 5.384 12 12h-2.408z"/></svg>
          </a>
        </span>
      
      <!-- Contact icon -->
      
      
        <span class="my-span-icon">
          <a href="/about.html" aria-label="Contact" title="Contact ">
            <svg class="my-svg-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"><path d="M12 .02c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.99 6.98l-6.99 5.666-6.991-5.666h13.981zm.01 10h-14v-8.505l7 5.673 7-5.672v8.504z"/></svg>
          </a>
        </span>
      

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
              
              
            
          
            
            
          
            
            
              
                <a class="page-link" href="/about.html">About</a>
              
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
              
                <a class="page-link" href="/2018/03/20/hlsl-basics.html"></a>
              
            
          
            
            
              
                <a class="page-link" href="/2018/03/20/hlsl-basics.html"></a>
              
            
          
            
            
              
                <a class="page-link" href="/2018/03/20/hlsl-basics.html"></a>
              
            
          
            
            
              
                <a class="page-link" href="/2018/03/20/hlsl-basics.html"></a>
              
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    
    
    

    <section class="page-header">
      <h1 class="project-name">Layered Noise</h1>
      <h2 class="project-tagline"></h2>
      
      <!-- Post tagline -->
      
        <h2 class="project-date">
        <time datetime="2018-09-22T00:00:00+02:00" itemprop="datePublished">
          
          Sep 22, 2018
        </time>
        
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ronja Böhringer</span></span>
        
        </h2>
      
      <!-- End: Post tagline -->
    </section>

    <section class="main-content">

      <article itemscope itemtype="http://schema.org/BlogPosting">

  <!-- <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Layered Noise</h1>
    <p class="post-meta">
      <time datetime="2018-09-22T00:00:00+02:00" itemprop="datePublished">
        
        Sep 22, 2018
      </time>
      </p>
  </header> -->

  
<ul>
  <li><a href="#layered-noise">Layered Noise</a></li>
  <li><a href="#layered-1d-noise">Layered 1d Noise</a></li>
  <li><a href="#layered-multidimensional-noise">Layered multidimensional Noise</a></li>
  <li><a href="#special-use-case">Special Use Case</a></li>
  <li><a href="#source">Source</a>
    <ul>
      <li><a href="#1d-layered-noise">1d layered noise</a></li>
      <li><a href="#2d-layered-noise">2d layered noise</a></li>
      <li><a href="#3d-layered-noise">3d layered noise</a></li>
      <li><a href="#scrolling-height-noise">Scrolling height noise</a></li>
    </ul>
  </li>
</ul>

  <div itemprop="articleBody">
    <h2 id="layered-noise">Layered Noise</h2>
<p>So far the noise we generated always looked either very soft, or very noisy. We can improve that by layering multiple layers of noise on top of each other. That way we get the structure of the soft noise as well as the interresting details of the more high frequency noise. Layering noise works well for <a href="/2018/09/08/value-noise.html">value noise</a> as well as <a href="/2018/09/15/perlin-noise.html">perlin noise</a>. While layering noise might give you patterns that are closer to what you intend to see, you also have to be careful if you worry about performance because each layer of noise you add costs you about as much performance as the first.</p>

<p><img src="/assets/images/posts/027/Result.gif" alt="" /></p>

<h2 id="layered-1d-noise">Layered 1d Noise</h2>
<p>We can already change the frequency, and by that change the roughness of the noise. We do that by changing the noise size variable.</p>

<p><img src="/assets/images/posts/027/PerlinSizes.gif" alt="" /></p>

<p>As in the previous tutorials, we’ll start by implementing the new technique in 1d. We start by sampling the noise twice, once like we did it before and another time with the noise value multiplied by 2. Multiplying the value means that the noise will change faster and be more high-frequency. After sampling the noise twice we add the second, more high-frequent noise, with less strength to the fist noise. This is possible with perlin noise because it is around 0, so it adds and subtracts values, if you use value noise I recommend remapping it around 0 (by multiplying it by 2 and subtracting 1) first and then adding the noise values.</p>

<p>For ease of reading we’ll also put the code we use for sampling noise in it’s own function.</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="nf">sampleLayeredNoise</span><span class="p">(</span><span class="kt">float</span> <span class="n">value</span><span class="p">){</span>
    <span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">gradientNoise</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">highFreqNoise</span> <span class="o">=</span> <span class="n">gradientNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">6</span><span class="p">);</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">highFreqNoise</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">surf</span> <span class="p">(</span><span class="n">Input</span> <span class="n">i</span><span class="p">,</span> <span class="k">inout</span> <span class="n">SurfaceOutputStandard</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">value</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
    
    <span class="kt">float</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">noise</span> <span class="o">-</span> <span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">pixelHeight</span> <span class="o">=</span> <span class="n">fwidth</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">lineIntensity</span> <span class="o">=</span> <span class="n">smoothstep</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pixelHeight</span><span class="p">,</span> <span class="n">pixelHeight</span><span class="p">,</span> <span class="n">dist</span><span class="p">);</span>
    <span class="n">o</span><span class="p">.</span><span class="n">Albedo</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lineIntensity</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p><img src="/assets/images/posts/027/2Sample1dGradient.png" alt="" /></p>

<p>This already gives us some of the effect we want, a overall structure with some rougher detail, but we can easily go further by sampling the noise even more often. The amount of times we sample the noise is also called octaves, so the example we have right now would be layered noise with 2 octaves.</p>

<p>To implement more octaves we will implement the sampling in a loop. We will also make the octaves less set in stone, instead we use a define statement to set it as a constant in our code. We could also make it completely variable, but then the compiler wouldn’t be able to optimize our loop by unrolling it so I’d like to avoid that. The frequency of each layer will be a multiple of the one before it, we will put that frequency multiplier in a variable and call it roughness. The amount which the layer will be factored in will be a fraction of the amount the previous layer is factored in, we’ll call that factor persistance. I also factored in the number of the loop into the noise sample, so that we don’t get weird artefacts at 0/0 where multiplying the value doesn’t change it which would lead to the same value being returned by the noise function for all layers.</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Properties</span> <span class="p">{</span>
    <span class="n">_CellSize</span> <span class="p">(</span><span class="s">"Cell Size"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_Roughness</span> <span class="p">(</span><span class="s">"Roughness"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_Persistance</span> <span class="p">(</span><span class="s">"Persistance"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//global shader variables</span>
<span class="cp">#define OCTAVES 4 
</span>
<span class="kt">float</span> <span class="n">_CellSize</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">_Roughness</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">_Persistance</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="nf">sampleLayeredNoise</span><span class="p">(</span><span class="kt">float</span> <span class="n">value</span><span class="p">){</span>
    <span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">gradientNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
        <span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
        <span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/027/Layered1dGradient.png" alt="" /></p>

<h2 id="layered-multidimensional-noise">Layered multidimensional Noise</h2>
<p>In multiple dimensions we basically do the same process, we just have to keep in mind that we have to use the appropriate vector type for the input. This is the sampling function for 2d noise:</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="nf">sampleLayeredNoise</span><span class="p">(</span><span class="n">float2</span> <span class="n">value</span><span class="p">){</span>
    <span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
        <span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
        <span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And this is for 3d noise:</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">float</span> <span class="nf">sampleLayeredNoise</span><span class="p">(</span><span class="n">float3</span> <span class="n">value</span><span class="p">){</span>
    <span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
        <span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
        <span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/027/NormalLayeredComparison.png" alt="" /></p>

<h2 id="special-use-case">Special Use Case</h2>

<p>Another thing noise is used for frequently is as a heightmap. For that we simply read the noise in the vertex shader instead of the fragment shader and add it to our vertex. In this part I will reference an <a href="/2018/06/16/Wobble-Displacement.html">earlier tutorial about displacement</a>, so if you have problems with this part I recommend reading this one first.</p>

<p>We first change our surface definition to include a vertex function as well as generate a custom shadow pass based on that <code class="language-plaintext highlighter-rouge">#pragma surface surf Standard fullforwardshadows vertex:vert addshadow</code>. Then we fill that new vertex function. Unity doesn’t pass us a world position automatically if we write a custom vertex function, but we can calculate it ourselved my simply multiplying the object to world matrix with the local vertex position. After sampling the noise like we’re used to we add it to the vertex position in the up(Y) axis. Because we’re not dealing with colors anymore I’m also going to add a amplitude variable which will allow us to set the strength of the noise. We’ll simply multiply the noise with the amplitude before applying it.</p>

<p>Now that we’re displaying the noise as hight, we’ll stop writing it in the fragment shader and instead just set the albedo color to white.</p>

<p>If we want to see all of the detail, we have to use a high resolution mesh in this case, otherwise there wouldn’t be that many polygons for the shader to translate.</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Properties</span> <span class="p">{</span>
    <span class="n">_CellSize</span> <span class="p">(</span><span class="s">"Cell Size"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_Roughness</span> <span class="p">(</span><span class="s">"Roughness"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_Persistance</span> <span class="p">(</span><span class="s">"Persistance"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
    <span class="n">_Amplitude</span><span class="p">(</span><span class="s">"Amplitude"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//global shader variables</span>
<span class="kt">float</span> <span class="n">_Amplitude</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">vert</span><span class="p">(</span><span class="k">inout</span> <span class="n">appdata_full</span> <span class="n">data</span><span class="p">){</span>
    <span class="n">float4</span> <span class="n">worldPos</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">vertex</span><span class="p">);</span>
    <span class="n">float3</span> <span class="n">value</span> <span class="o">=</span> <span class="n">worldPos</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
    <span class="c1">//get noise and adjust it to be ~0-1 range</span>
    <span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
    <span class="n">data</span><span class="p">.</span><span class="n">vertex</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">noise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">surf</span> <span class="p">(</span><span class="n">Input</span> <span class="n">i</span><span class="p">,</span> <span class="k">inout</span> <span class="n">SurfaceOutputStandard</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">o</span><span class="p">.</span><span class="n">Albedo</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/027/HeightNoiseWrongNormals.png" alt="" /></p>

<p>The problem with this so far is that we only changed the position of the vertices, but the mesh still thinks it’s a flat surface pointing up. The shadows we see are all thrown shadows where the mesh throws a shadow on itself. We can improve that by recalculating the shadows based on the new positions. (that part is explained in the displacement tutorial)</p>

<p>While making this tutorial I ran into the problem that the <code class="language-plaintext highlighter-rouge">w</code> component of the vector wasn’t 1, which means that the xyz components don’t represent the actual lengths. To fix that I had to divide the xyz components by the w component before using them.</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">vert</span><span class="p">(</span><span class="k">inout</span> <span class="n">appdata_full</span> <span class="n">data</span><span class="p">){</span>
    <span class="c1">//get real base position</span>
    <span class="n">float3</span> <span class="n">localPos</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">vertex</span> <span class="o">/</span> <span class="n">data</span><span class="p">.</span><span class="n">vertex</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>

    <span class="c1">//calculate new posiiton</span>
    <span class="n">float3</span> <span class="n">modifiedPos</span> <span class="o">=</span> <span class="n">localPos</span><span class="p">;</span>
    <span class="n">float2</span> <span class="n">basePosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">modifiedPos</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">basePosNoise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">basePosValue</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
    <span class="n">modifiedPos</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">basePosNoise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>
    
    <span class="c1">//calculate new position based on pos + tangent</span>
    <span class="n">float3</span> <span class="n">posPlusTangent</span> <span class="o">=</span> <span class="n">localPos</span> <span class="o">+</span> <span class="n">data</span><span class="p">.</span><span class="n">tangent</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">;</span>
    <span class="n">float2</span> <span class="n">tangentPosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">posPlusTangent</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">tangentPosNoise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">tangentPosValue</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
    <span class="n">posPlusTangent</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">tangentPosNoise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>

    <span class="c1">//calculate new position based on pos + bitangent</span>
    <span class="n">float3</span> <span class="n">bitangent</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">normal</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">tangent</span><span class="p">);</span>
    <span class="n">float3</span> <span class="n">posPlusBitangent</span> <span class="o">=</span> <span class="n">localPos</span> <span class="o">+</span> <span class="n">bitangent</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">;</span>
    <span class="n">float2</span> <span class="n">bitangentPosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">posPlusBitangent</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">bitangentPosNoise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">bitangentPosValue</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
    <span class="n">posPlusBitangent</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">bitangentPosNoise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>

    <span class="c1">//get recalculated tangent and bitangent</span>
    <span class="n">float3</span> <span class="n">modifiedTangent</span> <span class="o">=</span> <span class="n">posPlusTangent</span> <span class="o">-</span> <span class="n">modifiedPos</span><span class="p">;</span>
    <span class="n">float3</span> <span class="n">modifiedBitangent</span> <span class="o">=</span> <span class="n">posPlusBitangent</span> <span class="o">-</span> <span class="n">modifiedPos</span><span class="p">;</span>

    <span class="c1">//calculate new normal and set position + normal</span>
    <span class="n">float3</span> <span class="n">modifiedNormal</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">modifiedTangent</span><span class="p">,</span> <span class="n">modifiedBitangent</span><span class="p">);</span>
    <span class="n">data</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">modifiedNormal</span><span class="p">);</span>
    <span class="n">data</span><span class="p">.</span><span class="n">vertex</span> <span class="o">=</span> <span class="n">float4</span><span class="p">(</span><span class="n">modifiedPos</span><span class="p">.</span><span class="n">xyz</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/027/CorrectedNormals.png" alt="" /></p>

<p>Now that we did this we can also make it scroll, just to look nice. For that we’ll just add the vector multiplied by the time to the all input values.</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Properties</span>
<span class="n">_ScrollDirection</span><span class="p">(</span><span class="s">"Scroll Direction"</span><span class="p">,</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//global shader variables</span>
<span class="n">float2</span> <span class="n">_ScrollDirection</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//calculate base position</span>
<span class="n">float2</span> <span class="n">basePosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">modifiedPos</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span> <span class="o">+</span> <span class="n">_ScrollDirection</span> <span class="o">*</span> <span class="n">_Time</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//calculate tangent position</span>
<span class="n">float2</span> <span class="n">tangentPosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">posPlusTangent</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span> <span class="o">+</span> <span class="n">_ScrollDirection</span> <span class="o">*</span> <span class="n">_Time</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//calculate bitangent position</span>
<span class="n">float2</span> <span class="n">bitangentPosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">posPlusBitangent</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span> <span class="o">+</span> <span class="n">_ScrollDirection</span> <span class="o">*</span> <span class="n">_Time</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/027/Result.gif" alt="" /></p>

<h2 id="source">Source</h2>
<h3 id="1d-layered-noise">1d layered noise</h3>
<p><a href="https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_perlin_noise_1d.shader">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_perlin_noise_1d.shader</a></p>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Tutorial/027_layered_noise/1d"</span> <span class="p">{</span>
	<span class="n">Properties</span> <span class="p">{</span>
		<span class="n">_CellSize</span> <span class="p">(</span><span class="s">"Cell Size"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="n">_Roughness</span> <span class="p">(</span><span class="s">"Roughness"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="mi">3</span>
		<span class="n">_Persistance</span> <span class="p">(</span><span class="s">"Persistance"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
	<span class="p">}</span>
	<span class="n">SubShader</span> <span class="p">{</span>
		<span class="n">Tags</span><span class="p">{</span> <span class="s">"RenderType"</span><span class="o">=</span><span class="s">"Opaque"</span> <span class="s">"Queue"</span><span class="o">=</span><span class="s">"Geometry"</span><span class="p">}</span>

		<span class="n">CGPROGRAM</span>

		<span class="cp">#pragma surface surf Standard fullforwardshadows
</span>		<span class="cp">#pragma target 3.0
</span>
		<span class="cp">#include "Random.cginc"
</span>
		<span class="c1">//global shader variables</span>
		<span class="cp">#define OCTAVES 4 
</span>
		<span class="kt">float</span> <span class="n">_CellSize</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Roughness</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Persistance</span><span class="p">;</span>

		<span class="k">struct</span> <span class="n">Input</span> <span class="p">{</span>
			<span class="n">float3</span> <span class="n">worldPos</span><span class="p">;</span>
		<span class="p">};</span>

		<span class="kt">float</span> <span class="n">easeIn</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">easeIn</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeInOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">easeInValue</span> <span class="o">=</span> <span class="n">easeIn</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">easeOutValue</span> <span class="o">=</span> <span class="n">easeOut</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">lerp</span><span class="p">(</span><span class="n">easeInValue</span><span class="p">,</span> <span class="n">easeOutValue</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">gradientNoise</span><span class="p">(</span><span class="kt">float</span> <span class="n">value</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">fraction</span> <span class="o">=</span> <span class="n">frac</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">interpolator</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">);</span>

			<span class="kt">float</span> <span class="n">previousCellInclination</span> <span class="o">=</span> <span class="n">rand1dTo1d</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">previousCellLinePoint</span> <span class="o">=</span> <span class="n">previousCellInclination</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">;</span>

			<span class="kt">float</span> <span class="n">nextCellInclination</span> <span class="o">=</span> <span class="n">rand1dTo1d</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">nextCellLinePoint</span> <span class="o">=</span> <span class="n">nextCellInclination</span> <span class="o">*</span> <span class="p">(</span><span class="n">fraction</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

			<span class="k">return</span> <span class="n">lerp</span><span class="p">(</span><span class="n">previousCellLinePoint</span><span class="p">,</span> <span class="n">nextCellLinePoint</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="kt">float</span> <span class="n">value</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

			<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
				<span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">gradientNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
				<span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
				<span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">void</span> <span class="n">surf</span> <span class="p">(</span><span class="n">Input</span> <span class="n">i</span><span class="p">,</span> <span class="k">inout</span> <span class="n">SurfaceOutputStandard</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">float</span> <span class="n">value</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
			
			<span class="kt">float</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">noise</span> <span class="o">-</span> <span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">pixelHeight</span> <span class="o">=</span> <span class="n">fwidth</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">lineIntensity</span> <span class="o">=</span> <span class="n">smoothstep</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pixelHeight</span><span class="p">,</span> <span class="n">pixelHeight</span><span class="p">,</span> <span class="n">dist</span><span class="p">);</span>
			<span class="n">o</span><span class="p">.</span><span class="n">Albedo</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lineIntensity</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">ENDCG</span>
	<span class="p">}</span>
	<span class="n">FallBack</span> <span class="s">"Standard"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="2d-layered-noise">2d layered noise</h3>
<p><a href="https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_perlin_noise_2d.shader">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_perlin_noise_2d.shader</a></p>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Tutorial/027_layered_noise/2d"</span> <span class="p">{</span>
	<span class="n">Properties</span> <span class="p">{</span>
		<span class="n">_CellSize</span> <span class="p">(</span><span class="s">"Cell Size"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="n">_Roughness</span> <span class="p">(</span><span class="s">"Roughness"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="mi">3</span>
		<span class="n">_Persistance</span> <span class="p">(</span><span class="s">"Persistance"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
	<span class="p">}</span>
	<span class="n">SubShader</span> <span class="p">{</span>
		<span class="n">Tags</span><span class="p">{</span> <span class="s">"RenderType"</span><span class="o">=</span><span class="s">"Opaque"</span> <span class="s">"Queue"</span><span class="o">=</span><span class="s">"Geometry"</span><span class="p">}</span>

		<span class="n">CGPROGRAM</span>

		<span class="cp">#pragma surface surf Standard fullforwardshadows
</span>		<span class="cp">#pragma target 3.0
</span>
		<span class="cp">#include "Random.cginc"
</span>
		<span class="c1">//global shader variables</span>
		<span class="cp">#define OCTAVES 4 
</span>
		<span class="kt">float</span> <span class="n">_CellSize</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Roughness</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Persistance</span><span class="p">;</span>

		<span class="k">struct</span> <span class="n">Input</span> <span class="p">{</span>
			<span class="n">float3</span> <span class="n">worldPos</span><span class="p">;</span>
		<span class="p">};</span>

		<span class="kt">float</span> <span class="n">easeIn</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">easeIn</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeInOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">easeInValue</span> <span class="o">=</span> <span class="n">easeIn</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">easeOutValue</span> <span class="o">=</span> <span class="n">easeOut</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">lerp</span><span class="p">(</span><span class="n">easeInValue</span><span class="p">,</span> <span class="n">easeOutValue</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">float2</span> <span class="n">value</span><span class="p">){</span>
			<span class="c1">//generate random directions</span>
			<span class="n">float2</span> <span class="n">lowerLeftDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">lowerRightDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">upperLeftDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">upperRightDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

			<span class="n">float2</span> <span class="n">fraction</span> <span class="o">=</span> <span class="n">frac</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

			<span class="c1">//get values of cells based on fraction and cell directions</span>
			<span class="kt">float</span> <span class="n">lowerLeftFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">lowerLeftDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
			<span class="kt">float</span> <span class="n">lowerRightFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">lowerRightDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
			<span class="kt">float</span> <span class="n">upperLeftFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">upperLeftDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
			<span class="kt">float</span> <span class="n">upperRightFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">upperRightDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

			<span class="kt">float</span> <span class="n">interpolatorX</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">interpolatorY</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>

			<span class="c1">//interpolate between values</span>
			<span class="kt">float</span> <span class="n">lowerCells</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">lowerLeftFunctionValue</span><span class="p">,</span> <span class="n">lowerRightFunctionValue</span><span class="p">,</span> <span class="n">interpolatorX</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">upperCells</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">upperLeftFunctionValue</span><span class="p">,</span> <span class="n">upperRightFunctionValue</span><span class="p">,</span> <span class="n">interpolatorX</span><span class="p">);</span>

			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">lowerCells</span><span class="p">,</span> <span class="n">upperCells</span><span class="p">,</span> <span class="n">interpolatorY</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">float2</span> <span class="n">value</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

			<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
				<span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
				<span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
				<span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">void</span> <span class="n">surf</span> <span class="p">(</span><span class="n">Input</span> <span class="n">i</span><span class="p">,</span> <span class="k">inout</span> <span class="n">SurfaceOutputStandard</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">float2</span> <span class="n">value</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="n">worldPos</span><span class="p">.</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
			<span class="c1">//get noise and adjust it to be ~0-1 range</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>

			<span class="n">o</span><span class="p">.</span><span class="n">Albedo</span> <span class="o">=</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">ENDCG</span>
	<span class="p">}</span>
	<span class="n">FallBack</span> <span class="s">"Standard"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="3d-layered-noise">3d layered noise</h3>
<p><a href="https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_perlin_noise_3d.shader">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_perlin_noise_3d.shader</a></p>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Tutorial/027_layered_noise/3d"</span> <span class="p">{</span>
	<span class="n">Properties</span> <span class="p">{</span>
		<span class="n">_CellSize</span> <span class="p">(</span><span class="s">"Cell Size"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="n">_Roughness</span> <span class="p">(</span><span class="s">"Roughness"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="mi">3</span>
		<span class="n">_Persistance</span> <span class="p">(</span><span class="s">"Persistance"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
	<span class="p">}</span>
	<span class="n">SubShader</span> <span class="p">{</span>
		<span class="n">Tags</span><span class="p">{</span> <span class="s">"RenderType"</span><span class="o">=</span><span class="s">"Opaque"</span> <span class="s">"Queue"</span><span class="o">=</span><span class="s">"Geometry"</span><span class="p">}</span>

		<span class="n">CGPROGRAM</span>

		<span class="cp">#pragma surface surf Standard fullforwardshadows
</span>		<span class="cp">#pragma target 3.0
</span>
		<span class="cp">#include "Random.cginc"
</span>
		<span class="c1">//global shader variables</span>
		<span class="cp">#define OCTAVES 4 
</span>
		<span class="kt">float</span> <span class="n">_CellSize</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Roughness</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Persistance</span><span class="p">;</span>

		<span class="k">struct</span> <span class="n">Input</span> <span class="p">{</span>
			<span class="n">float3</span> <span class="n">worldPos</span><span class="p">;</span>
		<span class="p">};</span>

		<span class="kt">float</span> <span class="n">easeIn</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">easeIn</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeInOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">easeInValue</span> <span class="o">=</span> <span class="n">easeIn</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">easeOutValue</span> <span class="o">=</span> <span class="n">easeOut</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">lerp</span><span class="p">(</span><span class="n">easeInValue</span><span class="p">,</span> <span class="n">easeOutValue</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">float3</span> <span class="n">value</span><span class="p">){</span>
			<span class="n">float3</span> <span class="n">fraction</span> <span class="o">=</span> <span class="n">frac</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

			<span class="kt">float</span> <span class="n">interpolatorX</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">interpolatorY</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">interpolatorZ</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>

			<span class="n">float3</span> <span class="n">cellNoiseZ</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
			<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">z</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">z</span><span class="o">++</span><span class="p">){</span>
				<span class="n">float3</span> <span class="n">cellNoiseY</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
				<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
				<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">y</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">y</span><span class="o">++</span><span class="p">){</span>
					<span class="n">float3</span> <span class="n">cellNoiseX</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
					<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
					<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">x</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">x</span><span class="o">++</span><span class="p">){</span>
						<span class="n">float3</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="n">float3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
						<span class="n">float3</span> <span class="n">cellDirection</span> <span class="o">=</span> <span class="n">rand3dTo3d</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
						<span class="n">float3</span> <span class="n">compareVector</span> <span class="o">=</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
						<span class="n">cellNoiseX</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">cellDirection</span><span class="p">,</span> <span class="n">compareVector</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">cellNoiseY</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">cellNoiseX</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cellNoiseX</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">interpolatorX</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">cellNoiseZ</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">cellNoiseY</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cellNoiseY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">interpolatorY</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">float3</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">cellNoiseZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cellNoiseZ</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">interpolatorZ</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">float3</span> <span class="n">value</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

			<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
				<span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
				<span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
				<span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">void</span> <span class="n">surf</span> <span class="p">(</span><span class="n">Input</span> <span class="n">i</span><span class="p">,</span> <span class="k">inout</span> <span class="n">SurfaceOutputStandard</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">float3</span> <span class="n">value</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="n">worldPos</span> <span class="o">/</span> <span class="n">_CellSize</span><span class="p">;</span>
			<span class="c1">//get noise and adjust it to be ~0-1 range</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>

			<span class="n">o</span><span class="p">.</span><span class="n">Albedo</span> <span class="o">=</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">ENDCG</span>
	<span class="p">}</span>
	<span class="n">FallBack</span> <span class="s">"Standard"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="scrolling-height-noise">Scrolling height noise</h3>
<p><a href="https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_noise_special.shader">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/027_Layered_Noise/layered_noise_special.shader</a></p>
<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Shader</span> <span class="s">"Tutorial/027_layered_noise/special_use_case"</span> <span class="p">{</span>
	<span class="n">Properties</span> <span class="p">{</span>
		<span class="n">_CellSize</span> <span class="p">(</span><span class="s">"Cell Size"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="n">_Roughness</span> <span class="p">(</span><span class="s">"Roughness"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">=</span> <span class="mi">3</span>
		<span class="n">_Persistance</span> <span class="p">(</span><span class="s">"Persistance"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
		<span class="n">_Amplitude</span><span class="p">(</span><span class="s">"Amplitude"</span><span class="p">,</span> <span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="n">_ScrollDirection</span><span class="p">(</span><span class="s">"Scroll Direction"</span><span class="p">,</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">SubShader</span> <span class="p">{</span>
		<span class="n">Tags</span><span class="p">{</span> <span class="s">"RenderType"</span><span class="o">=</span><span class="s">"Opaque"</span> <span class="s">"Queue"</span><span class="o">=</span><span class="s">"Geometry"</span><span class="p">}</span>

		<span class="n">CGPROGRAM</span>

		<span class="cp">#pragma surface surf Standard fullforwardshadows vertex:vert addshadow
</span>		<span class="cp">#pragma target 3.0 
</span>
		<span class="cp">#include "Random.cginc"
</span>
		<span class="c1">//global shader variables</span>
		<span class="cp">#define OCTAVES 4 
</span>
		<span class="kt">float</span> <span class="n">_CellSize</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Roughness</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Persistance</span><span class="p">;</span>
		<span class="kt">float</span> <span class="n">_Amplitude</span><span class="p">;</span>

		<span class="n">float2</span> <span class="n">_ScrollDirection</span><span class="p">;</span>

		<span class="k">struct</span> <span class="n">Input</span> <span class="p">{</span>
			<span class="n">float3</span> <span class="n">worldPos</span><span class="p">;</span>
		<span class="p">};</span>

		<span class="kt">float</span> <span class="n">easeIn</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="n">interpolator</span> <span class="o">*</span> <span class="n">interpolator</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">easeIn</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">easeInOut</span><span class="p">(</span><span class="kt">float</span> <span class="n">interpolator</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">easeInValue</span> <span class="o">=</span> <span class="n">easeIn</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">easeOutValue</span> <span class="o">=</span> <span class="n">easeOut</span><span class="p">(</span><span class="n">interpolator</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">lerp</span><span class="p">(</span><span class="n">easeInValue</span><span class="p">,</span> <span class="n">easeOutValue</span><span class="p">,</span> <span class="n">interpolator</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">float2</span> <span class="n">value</span><span class="p">){</span>
			<span class="c1">//generate random directions</span>
			<span class="n">float2</span> <span class="n">lowerLeftDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">lowerRightDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">upperLeftDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">upperRightDirection</span> <span class="o">=</span> <span class="n">rand2dTo2d</span><span class="p">(</span><span class="n">float2</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">y</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

			<span class="n">float2</span> <span class="n">fraction</span> <span class="o">=</span> <span class="n">frac</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

			<span class="c1">//get values of cells based on fraction and cell directions</span>
			<span class="kt">float</span> <span class="n">lowerLeftFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">lowerLeftDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
			<span class="kt">float</span> <span class="n">lowerRightFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">lowerRightDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
			<span class="kt">float</span> <span class="n">upperLeftFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">upperLeftDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
			<span class="kt">float</span> <span class="n">upperRightFunctionValue</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">upperRightDirection</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">-</span> <span class="n">float2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

			<span class="kt">float</span> <span class="n">interpolatorX</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">interpolatorY</span> <span class="o">=</span> <span class="n">easeInOut</span><span class="p">(</span><span class="n">fraction</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>

			<span class="c1">//interpolate between values</span>
			<span class="kt">float</span> <span class="n">lowerCells</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">lowerLeftFunctionValue</span><span class="p">,</span> <span class="n">lowerRightFunctionValue</span><span class="p">,</span> <span class="n">interpolatorX</span><span class="p">);</span>
			<span class="kt">float</span> <span class="n">upperCells</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">upperLeftFunctionValue</span><span class="p">,</span> <span class="n">upperRightFunctionValue</span><span class="p">,</span> <span class="n">interpolatorX</span><span class="p">);</span>

			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">lerp</span><span class="p">(</span><span class="n">lowerCells</span><span class="p">,</span> <span class="n">upperCells</span><span class="p">,</span> <span class="n">interpolatorY</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="kt">float</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">float2</span> <span class="n">value</span><span class="p">){</span>
			<span class="kt">float</span> <span class="n">noise</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

			<span class="p">[</span><span class="n">unroll</span><span class="p">]</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">OCTAVES</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
				<span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">perlinNoise</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">72354</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
				<span class="n">factor</span> <span class="o">*=</span> <span class="n">_Persistance</span><span class="p">;</span>
				<span class="n">frequency</span> <span class="o">*=</span> <span class="n">_Roughness</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">return</span> <span class="n">noise</span><span class="p">;</span>
		<span class="p">}</span>
		
		<span class="kt">void</span> <span class="n">vert</span><span class="p">(</span><span class="k">inout</span> <span class="n">appdata_full</span> <span class="n">data</span><span class="p">){</span>
			<span class="c1">//get real base position</span>
			<span class="n">float3</span> <span class="n">localPos</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">vertex</span> <span class="o">/</span> <span class="n">data</span><span class="p">.</span><span class="n">vertex</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>

			<span class="c1">//calculate new posiiton</span>
			<span class="n">float3</span> <span class="n">modifiedPos</span> <span class="o">=</span> <span class="n">localPos</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">basePosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">modifiedPos</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span> <span class="o">+</span> <span class="n">_ScrollDirection</span> <span class="o">*</span> <span class="n">_Time</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">basePosNoise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">basePosValue</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
			<span class="n">modifiedPos</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">basePosNoise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>
			
			<span class="c1">//calculate new position based on pos + tangent</span>
			<span class="n">float3</span> <span class="n">posPlusTangent</span> <span class="o">=</span> <span class="n">localPos</span> <span class="o">+</span> <span class="n">data</span><span class="p">.</span><span class="n">tangent</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">tangentPosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">posPlusTangent</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span> <span class="o">+</span> <span class="n">_ScrollDirection</span> <span class="o">*</span> <span class="n">_Time</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">tangentPosNoise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">tangentPosValue</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
			<span class="n">posPlusTangent</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">tangentPosNoise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>

			<span class="c1">//calculate new position based on pos + bitangent</span>
			<span class="n">float3</span> <span class="n">bitangent</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">normal</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">tangent</span><span class="p">);</span>
			<span class="n">float3</span> <span class="n">posPlusBitangent</span> <span class="o">=</span> <span class="n">localPos</span> <span class="o">+</span> <span class="n">bitangent</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mo">02</span><span class="p">;</span>
			<span class="n">float2</span> <span class="n">bitangentPosValue</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">unity_ObjectToWorld</span><span class="p">,</span> <span class="n">posPlusBitangent</span><span class="p">).</span><span class="n">xz</span> <span class="o">/</span> <span class="n">_CellSize</span> <span class="o">+</span> <span class="n">_ScrollDirection</span> <span class="o">*</span> <span class="n">_Time</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
			<span class="kt">float</span> <span class="n">bitangentPosNoise</span> <span class="o">=</span> <span class="n">sampleLayeredNoise</span><span class="p">(</span><span class="n">bitangentPosValue</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
			<span class="n">posPlusBitangent</span><span class="p">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">bitangentPosNoise</span> <span class="o">*</span> <span class="n">_Amplitude</span><span class="p">;</span>

			<span class="c1">//get recalculated tangent and bitangent</span>
			<span class="n">float3</span> <span class="n">modifiedTangent</span> <span class="o">=</span> <span class="n">posPlusTangent</span> <span class="o">-</span> <span class="n">modifiedPos</span><span class="p">;</span>
			<span class="n">float3</span> <span class="n">modifiedBitangent</span> <span class="o">=</span> <span class="n">posPlusBitangent</span> <span class="o">-</span> <span class="n">modifiedPos</span><span class="p">;</span>

			<span class="c1">//calculate new normal and set position + normal</span>
			<span class="n">float3</span> <span class="n">modifiedNormal</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">modifiedTangent</span><span class="p">,</span> <span class="n">modifiedBitangent</span><span class="p">);</span>
			<span class="n">data</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">modifiedNormal</span><span class="p">);</span>
			<span class="n">data</span><span class="p">.</span><span class="n">vertex</span> <span class="o">=</span> <span class="n">float4</span><span class="p">(</span><span class="n">modifiedPos</span><span class="p">.</span><span class="n">xyz</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="kt">void</span> <span class="n">surf</span> <span class="p">(</span><span class="n">Input</span> <span class="n">i</span><span class="p">,</span> <span class="k">inout</span> <span class="n">SurfaceOutputStandard</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">o</span><span class="p">.</span><span class="n">Albedo</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">ENDCG</span>
	<span class="p">}</span>
	<span class="n">FallBack</span> <span class="s">"Standard"</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Octaves are a great way to add complexity to your noise patterns. You can also try to use the same technique to mix different kinds of noise and see what happens. In any case I hope that you learned how it works and you can do amazing stuff with it. If you feel like something is missing or confusing, just write me.</p>


    <p>
        You can also find me on twitter at <a href="https://www.twitter.com/totallyRonja">@totallyRonja</a>. If you liked my tutorial and want to support me you can do that on Patreon (<a href="https://www.patreon.com/RonjaTutorials">patreon.com/RonjaTutorials</a>) or Ko-Fi (<a href="https://ko-fi.com/RonjaTutorials">ko-fi.com/RonjaTutorials</a>).
    </p>
  </div>

  
    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://ronja-tutorials.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
  
</article>


      <!-- SVG icons from https://iconmonstr.com -->

      <!-- Twitter icon -->
      <span class="my-span-icon">
          <a href="https://twitter.com/TotallyRonja" aria-label="'s Twitter" title="'s Twitter">
            <svg class="my-svg-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" style="margin-top: 12px;margin-left: 13px;"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"/></svg>
          </a>
        </span>

        <!-- RSS icon -->
        
          <span class="my-span-icon">
            <a href="/feed.xml" aria-label="RSS feed" title="'s RSS feed">
              <svg class="my-svg-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-3.374 17c-.897 0-1.626-.727-1.626-1.624s.729-1.624 1.626-1.624 1.626.727 1.626 1.624-.729 1.624-1.626 1.624zm3.885 0c-.03-3.022-2.485-5.474-5.511-5.504v-2.406c4.361.03 7.889 3.555 7.92 7.91h-2.409zm4.081 0c-.016-5.297-4.303-9.571-9.592-9.594v-2.406c6.623.023 11.985 5.384 12 12h-2.408z"/></svg>
            </a>
          </span>
        
        <!-- Contact icon -->
        
        
          <span class="my-span-icon">
            <a href="/about.html" aria-label="Contact" title="Contact ">
              <svg class="my-svg-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"><path d="M12 .02c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.99 6.98l-6.99 5.666-6.991-5.666h13.981zm.01 10h-14v-8.505l7 5.673 7-5.672v8.504z"/></svg>
            </a>
          </span>
        
    </section>

    
      <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-124040112-1', 'auto');
        ga('send', 'pageview');
      </script>
    
  </body>
</html>
